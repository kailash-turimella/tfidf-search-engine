package main

import (
	"testing"

	"slices"
)

func TestDownload(t *testing.T) {
	tests := []struct {
		url        string
		wantedBody []byte
		num        int
	}{
		// Basic case
		{
			url: "https://usf-cs272-s25.github.io/test-data/lab02a/index.html",
			wantedBody: []byte{
				60, 104, 116, 109, 108, 62, 10, 60, 98, 111, 100, 121, 62, 10, 32, 32,
				60, 117, 108, 62, 10, 32, 32, 32, 32, 60, 108, 105, 62, 10, 32, 32, 32,
				32, 32, 32, 60, 97, 32, 104, 114, 101, 102, 61, 34, 47, 116, 101, 115,
				116, 45, 100, 97, 116, 97, 47, 108, 97, 98, 48, 50, 97, 47, 115, 105,
				109, 112, 108, 101, 46, 104, 116, 109, 108, 34, 62, 115, 105, 109, 112,
				108, 101, 46, 104, 116, 109, 108, 60, 47, 97, 62, 10, 32, 32, 32, 32,
				60, 47, 108, 105, 62, 10, 32, 32, 32, 32, 60, 108, 105, 62, 10, 32, 32,
				32, 32, 32, 32, 60, 97, 32, 104, 114, 101, 102, 61, 34, 47, 116, 101,
				115, 116, 45, 100, 97, 116, 97, 47, 108, 97, 98, 48, 50, 97, 47, 104,
				114, 101, 102, 46, 104, 116, 109, 108, 34, 62, 104, 114, 101, 102, 46,
				104, 116, 109, 108, 60, 47, 97, 62, 10, 32, 32, 32, 32, 60, 47, 108,
				105, 62, 10, 32, 32, 32, 32, 60, 108, 105, 62, 10, 32, 32, 32, 32, 32,
				32, 60, 97, 32, 104, 114, 101, 102, 61, 34, 47, 116, 101, 115, 116, 45,
				100, 97, 116, 97, 47, 108, 97, 98, 48, 50, 97, 47, 115, 116, 121, 108,
				101, 46, 104, 116, 109, 108, 34, 62, 115, 116, 121, 108, 101, 46, 104,
				116, 109, 108, 60, 47, 97, 62, 10, 32, 32, 60, 47, 117, 108, 62, 10,
				60, 47, 98, 111, 100, 121, 62, 10, 60, 47, 104, 116, 109, 108, 62, 10,
			},
			num: 1,
		},
		{
			url: "https://usf-cs272-s25.github.io/test-data/lab02a/href.html",
			wantedBody: []byte{
				60, 104, 116, 109, 108, 62, 10, 60, 98, 111, 100, 121, 62, 10, 70, 111,
				114, 32, 97, 32, 115, 105, 109, 112, 108, 101, 32, 101, 120, 97, 109,
				112, 108, 101, 44, 32, 115, 101, 101, 32, 60, 97, 32, 104, 114, 101,
				102, 61, 34, 47, 116, 101, 115, 116, 45, 100, 97, 116, 97, 47, 108, 97,
				98, 48, 50, 97, 47, 115, 105, 109, 112, 108, 101, 46, 104, 116, 109,
				108, 34, 62, 115, 105, 109, 112, 108, 101, 46, 104, 116, 109, 108, 60,
				47, 97, 62, 10, 60, 47, 98, 111, 100, 121, 62, 10, 60, 47, 104, 116,
				109, 108, 62, 10,
			},
			num: 2,
		},
		{
			url: "https://usf-cs272-s25.github.io/test-data/lab02a/simple.html",
			wantedBody: []byte{
				60, 104, 116, 109, 108, 62, 10, 60, 98, 111, 100, 121, 62, 10, 72, 101,
				108, 108, 111, 32, 67, 83, 32, 50, 55, 50, 44, 32, 116, 104, 101, 114,
				101, 32, 97, 114, 101, 32, 110, 111, 32, 108, 105, 110, 107, 115, 32,
				104, 101, 114, 101, 46, 10, 60, 47, 98, 111, 100, 121, 62, 10, 60, 47,
				104, 116, 109, 108, 62, 10,
			},
			num: 3,
		},
		{
			url: "https://usf-cs272-s25.github.io/test-data/lab02a/style.html",
			wantedBody: []byte{
				60, 104, 116, 109, 108, 62, 10, 60, 104, 101, 97, 100, 62, 10, 32, 32,
				60, 116, 105, 116, 108, 101, 62, 83, 116, 121, 108, 101, 60, 47, 116,
				105, 116, 108, 101, 62, 10, 32, 32, 60, 115, 116, 121, 108, 101, 62,
				10, 32, 32, 32, 32, 97, 46, 98, 108, 117, 101, 32, 123, 10, 32, 32,
				32, 32, 32, 32, 99, 111, 108, 111, 114, 58, 32, 98, 108, 117, 101,
				59, 10, 32, 32, 32, 32, 125, 10, 32, 32, 32, 32, 97, 46, 114, 101,
				100, 32, 123, 10, 32, 32, 32, 32, 32, 32, 99, 111, 108, 111, 114, 58,
				32, 114, 101, 100, 59, 10, 32, 32, 32, 32, 125, 10, 32, 32, 60, 47,
				115, 116, 121, 108, 101, 62, 10, 60, 98, 111, 100, 121, 62, 10, 32,
				32, 60, 112, 62, 10, 32, 32, 32, 32, 72, 101, 114, 101, 32, 105, 115,
				32, 97, 32, 98, 108, 117, 101, 32, 108, 105, 110, 107, 32, 116, 111,
				32, 60, 97, 32, 99, 108, 97, 115, 115, 61, 34, 98, 108, 117, 101, 34,
				32, 104, 114, 101, 102, 61, 34, 47, 116, 101, 115, 116, 45, 100, 97,
				116, 97, 47, 108, 97, 98, 48, 50, 97, 47, 104, 114, 101, 102, 46, 104,
				116, 109, 108, 34, 62, 104, 114, 101, 102, 46, 104, 116, 109, 108, 60,
				47, 97, 62, 10, 32, 32, 60, 47, 112, 62, 10, 32, 32, 60, 112, 62, 10,
				32, 32, 32, 32, 65, 110, 100, 32, 97, 32, 114, 101, 100, 32, 108, 105,
				110, 107, 32, 116, 111, 32, 60, 97, 32, 99, 108, 97, 115, 115, 61, 34,
				114, 101, 100, 34, 32, 104, 114, 101, 102, 61, 34, 47, 116, 101, 115,
				116, 45, 100, 97, 116, 97, 47, 108, 97, 98, 48, 50, 97, 47, 115, 105,
				109, 112, 108, 101, 46, 104, 116, 109, 108, 34, 62, 115, 105, 109, 112,
				108, 101, 46, 104, 116, 109, 108, 60, 47, 97, 62, 10, 32, 32, 60, 47,
				112, 62, 10, 60, 47, 98, 111, 100, 121, 62, 10, 60, 47, 104, 116, 109,
				108, 62, 10,
			},
			num: 4,
		},
	}

	for _, test := range tests {
		body, err := download(test.url)
		if err != nil {
			t.Fatalf("TEST %d: error downloading test %v", test.num, err)
		}
		if !slices.Equal(body, test.wantedBody) {
			t.Errorf("TEST %d FAILED body = %v, want %v", test.num, body, test.wantedBody)
		}
	}
}
